<!DOCTYPE html>
<html lang="ru">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	
	<title>Uniledge | Регистрация</title>
	<link rel="shortcut icon" href="img/favicon.ico">
	<link rel="stylesheet" href="css/main.css">

</head>
<body>

	<header class="header login-section" id="header">
		<p class="beta">Сайт находится в бета-версии. Разработка продолжается.</p>
			<nav id="navbar" class="navbar">
				<a href="index.php"><div class="logo" id="logo">
					<h3><span>Uni</span>ledge</h3>
					<div class="line">
						<div class="blue"></div>
					</div>
				</div></a>

				<form class="search-box" id="search-box" action="search.php" method="POST">
					<div class="zoom" id="zoom"><img src="img/Zoom.svg" alt="Поиск"></div>
					<input type="text" name="search-input" placeholder="Мой любимый университет" pattern="^[A-Za-zА-Яа-яЁё\s]+$" class="search-input" id="search-input" title="Разрешен ввод только русских и латинских букв">
				</form>

				<div class="menu">
					<ul class="topmenu" id="topmenu">
						<li><a href="Login.html" class="login-btn">Войти</a></li>
						<li><a href="signup.html" class="registration-btn">Регистрация</a></li>
					</ul>
				</div>
			</nav>
	</header>


	<section id="login-page" class="login-page">
		<img src="img/bg-item2.svg" alt="" class="bg-item2 item2">

		<form action="check.php" method="post">

			<div class="general-off">
				<div class="general-login center">
					<h1>Добро пожаловать в <span class="">Uni</span>ledge</h1>
					<p class="small">Создай аккаунт и управляй своим образовательным процессом</p>

					<div class="names">
						<div class="a">
							<label for="last-reg">Фамилия</label>
							<input type="text" name="last-reg" maxlength="30" class="email-login" pattern='^[A-Za-zА-Яа-яЁё\s]+$' id="lastname-login" required>
						</div>
						<div class="a">
							<label for="name-reg">Имя</label>
							<input type="text" name="name-reg" maxlength="30" class="email-login" pattern='^[A-Za-zА-Яа-яЁё\s]+$' id="firstname-login" required>
						</div>
					</div>
					<form action="valid.php">
							<div class="a">
								<label for="email-login" id="label-email">Email</label>
								<input type="email" name="email-reg" class="email-login" pattern='^[A-Za-zА0-9@,."-_\s]+$' id="email-login" required>
							</div>
					</form>
					<label for="password-login">Пароль</label>
					<input type="password" name="password-login" pattern='^[A-Za-zА-Яа-яЁё0-9@"\s]+$' class="email-login" minlength="5" maxlength="16" id="password-login" title="Пароль должен содержать 5-16 символов включая буквы большого регистра, цифры и знаком @ и двойных ковычек" onchange="check()" required>
					<label for="confirm-login" >Подтвердите пароль</label>
					<input type="password" name="confirm-login" pattern='^[A-Za-zА-Яа-яЁё0-9@"\s]+$' class="email-login" minlength="5"  maxlength="16" id="confirm-login" onchange="check()" required>
					<div class="bar">
						<div class="bar-1"></div>
						<div class="bar-2"></div>
						<div class="bar-3"></div>
						<div class="bar-4"></div>
					</div>
					
					<p style="font-size: 12px">Пароль должен содержать 5-16 символов включая буквы верхнего регистра, цифры и любой из знаков @ и двойных ковычек</p>
				</div>
				<div class="agreement-block" style="grid-column-start: 1; grid-column-end: 3;">
					<input type="checkbox" name="agreement-check" id="agreement-check" required>
					<label for="agreement-check">Я подтверждаю свое согласие на использование cookie для хранения данных</label>
				</div>
				<button type="submit" id="btn-sub" class="btn accent" name="signup_button" style="text-align: center">Зарегистрироваться</button>
				<a href="Login.html" class="btn" style="text-align: center">Войти в аккаунт</a>
			</div>

		</form>

	</section>


	<footer class="footer" id="footer">
		<div class="group">
		<a href="index.php">
			<div class="logo" id="logo">
			<h3 style="color: #F3F3F3"><span>Uni</span>ledge</h3>
			<div class="line">
			<div class="blue"></div>
			</div>
			</div>
		</a>
		<div class="subscribe-box">
			<p>Если вы хотите получать уведомления о новых обновлениях и внутренних грантах университетов</p>
			<a href="https://t.me/uniknowledge" target="blank" class="btn" style="color: #fff; border-color: #aaa; margin-bottom: 3vh">Join telegram</a>
		</div>
		</div>
		<div class="common-group">
		<div class="group2">
			<h3>Контакты</h3>
			<a href="mailto:support@uni1edge.kz" class="link-footer">support@uni1edge.kz</a><br><br>
		</div>
		<div class="group2">
			<h3>Помощь</h3>
			<div class="links-footer">
			<a href="help.php" class="link-footer">Помощь</a><br><br>
			</div>
			<p>2020 @ Uniledge.kz</p>
		</div>
		</div>
 	</footer>
	
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
	<script src="js/jquery.maskedinput.min.js" type="text/javascript"></script>
	<script src="js/main.js"></script>
	<script>
		var em;
		$('#email-login').bind('blur', function() {
				$.ajax({
					url: "valid.php",
					type: "POST",
					data: ({email: $('input[name="email-reg"]').val()}),
					dataType: "html",
					beforeSend: function() {
						$('#label-email').text('Проверка...');
					},
					success: function(data) {
						data = JSON.parse(data);
						if(data == "Пользователь с таким email уже зарегистрирован") {
							$('#label-email').text(data).css('color', 'red');
							$('#email-login').css('border', '1px solid red');
							$('#btn-sub').prop('disabled', true).removeClass('btn').removeClass('accent').addClass('disabled-btn');
							em = 0;
						} else {
							$('#label-email').text(data).css('color', '#2CA5EB');
							$('#email-login').css('border', '1px solid #2CA5EB');
							if(cnt == 4) {
								$('#btn-sub').prop('disabled', false).addClass('btn').addClass('accent').removeClass('disabled-btn');
							}
							em = 1;
						}
					}
				})
		})
		var cnt;
		$('input[name="password-login"]').keyup(function(){
            var pass = $('input[name="password-login"]').val();
			cnt = 0;
            for(var i = 0;i<pass.length;i++){
                if(pass.charCodeAt(i) >= 65 && pass.charCodeAt(i) <= 90){
                    cnt ++;
                    break;
                }
            }
            for(var i = 0;i<pass.length;i++){
                if(pass.charCodeAt(i) == 34 || pass.charCodeAt(i) == 64){
                    cnt ++;
                    break;
                }
            }
            for(var i = 0;i<pass.length;i++){
                if(pass.charCodeAt(i) >= 48 && pass.charCodeAt(i) <= 57){
                    cnt ++;
                    break;
                }
            }
            if(pass.length >= 5){
                cnt ++;
            }
            if(cnt == 1){
                $(".bar-1").fadeIn();
                $(".bar-2").fadeOut();
                $(".bar-3").fadeOut();
                $(".bar-4").fadeOut();
            }
            if(cnt == 2){
                $(".bar-1").fadeIn();
                $(".bar-2").fadeIn();
                $(".bar-3").fadeOut();
                $(".bar-4").fadeOut();
            }
            if(cnt == 3){
                $(".bar-1").fadeIn();
                $(".bar-2").fadeIn();
                $(".bar-3").fadeIn();
                $(".bar-4").fadeOut();
            }
            if(cnt == 4){
                $(".bar-1").fadeIn('fast');
                $(".bar-2").fadeIn('fast');
                $(".bar-3").fadeIn('fast');
                $(".bar-4").fadeIn('fast');
            }
            else if(cnt == 0){
                $(".bar-1").fadeOut();
                $(".bar-2").fadeOut();
                $(".bar-3").fadeOut();
                $(".bar-4").fadeOut();
            }
            else if(cnt != 4) {
                $('button[type="submit"]').prop("disabled", true).addClass('disabled-btn').removeClass('btn').removeClass('accent');
            }
        })

		function check() {
			let value1 = $('#confirm-login').val();
			let value2 = $('#password-login').val();

			if(value1 != value2) {
				$('label[for="confirm-login"]').text('Пароли не совпадают').css('color', 'red');
				$('#btn-sub').prop('disabled', true).addClass('disabled-btn').removeClass('accent').removeClass('btn');
			} else {
				$('label[for="confirm-login"]').text('Пароли совпадают').css('color', '#2a2a2a');
				if(em ==1 && cnt == 4) {
					$('#btn-sub').prop('disabled', false).removeClass('disabled-btn').addClass('accent').addClass('btn');
				}
			}
		}
	</script>
</body>
</html>
